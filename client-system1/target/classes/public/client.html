<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<link rel="stylesheet" type="text/css"  href="/js/layui2/css/layui.css">
<link href="/js/layui2/formSelects-v4.css" rel="stylesheet" />
<body>
<fieldset class="layui-elem-field layui-field-title">
    <legend>新开就诊</legend>
</fieldset>
<div align="center">
    <form class="layui-form layui-form-pane1 " action="" lay-filter="first">
        <div class="layui-inline" style="margin-left: -100px">
            <label class="layui-form-label">患者名称</label>
            <div class="layui-input-block">
                <select name="patientName" lay-filter="patientName" lay-verify="required" lay-verType="tips">
                </select>
            </div>
            <br/>
            <label class="layui-form-label">性别</label>
            <div class="layui-input-block">
                <!--<select name="categoryLevel1Name"  lay-filter="categoryLevel1Name">
                </select>-->
                <input type="text" name="gender"   placeholder="请输入性别" autocomplete="off" class="layui-input" >
            </div>
        </div>


        <div class="layui-inline" style="margin-left: 20px">
            <label class="layui-form-label">患者卡号</label>
            <div class="layui-input-block">
                <input type="text" name="patientNo"   placeholder="请输入患者卡号" autocomplete="off" class="layui-input" >
            </div>
            <br/>
            <label class="layui-form-label">手机号码</label>
            <div class="layui-input-block">
                <!--    <select name="categoryLevel2Name" lay-filter="categoryLevel2Name" lay-verify="required" lay-verType="tips">

                    </select>-->
                <input type="text" name="phone"   placeholder="请输入手机号码" autocomplete="off" class="layui-input" >
            </div>
        </div>
        <div class="layui-inline" style="margin-left: 20px">
            <label class="layui-form-label">患者年龄</label>
            <div class="layui-input-block">
                <!--<select name="flatformName" lay-verify="required" lay-verType="tips">

                </select>-->
                <input type="text" name="patientAge"   placeholder="请输入患者年龄" autocomplete="off" class="layui-input" >
            </div>
            <br/>
            <label class="layui-form-label">证件号</label>
            <div class="layui-input-block">
                <input type="text" name="patientCard"   placeholder="请输入证件号" autocomplete="off" class="layui-input" >
            </div>
        </div>
        <div class="layui-inline" style="margin-left: 20px">
            <label class="layui-form-label">出生日期</label>
            <div class="layui-input-block">
                <!--<select name="flatformName" lay-verify="required" lay-verType="tips">
                </select>-->
                <input type="date" name="bornDate"   placeholder="请输入出生日期" autocomplete="off" class="layui-input" >
            </div>
            <br/>
            <label class="layui-form-label">接诊类型</label>
            <div class="layui-input-block">
                <select name="status" lay-verify="required" lay-verType="tips">
                    <option>请选择</option>
                    <option value="1">初诊</option>
                    <option value="2">复诊</option>
                </select>
            </div>
        </div>
        <br/>
        <div class="layui-inline" style="margin-left: -1010px;margin-top: 20px">
            <label class="layui-form-label">地址</label>
            <div class="layui-input-block" style="width: 300px">
                <!--<select name="flatformName" lay-verify="required" lay-verType="tips">
                </select>-->
                <input type="text" name="softwareName"   placeholder="请输入出生日期" autocomplete="off" class="layui-input" >
            </div>
            <br/>
            <label class="layui-form-label">诊断</label>
            <div class="layui-input-block" style="width: 300px">
                <select name="select_base_cityname" id="select_base_cityname" lay-filter="select_base_cityname" xm-select="select_base_cityname" xm-select-type="1">
                    <option value=""></option>
                    <option value="1">北京</option>
                    <option value="2">上海</option>
                    <option value="3">天津</option>
                    <option value="4">重庆</option>
                </select>
            </div>

        </div>
        <br/>
        <div class="layui-inline" style="margin-left: -105px;margin-top: -120px;">
            <label class="layui-form-label">详细地址</label>
            <div class="layui-input-block" style="width:300px;">
                <input type="text" name="softwareName"   placeholder="请输入性别" autocomplete="off" class="layui-input" >
            </div>
            <br/>
            <label class="layui-form-label">医嘱</label>
            <div class="layui-input-block">
                <div class="layui-input-block" style="width: 300px;margin-left: -1px;border: 1px solid #F2F2F2">
                    <select name="select_base_cityname2" id="select_base_cityname2" lay-filter="select_base_cityname2" xm-select="select_base_cityname2" xm-select-type="1">
                        <option value=""></option>
                        <option value="1">北京</option>
                        <option value="2">上海</option>
                        <option value="3">天津</option>
                        <option value="4">重庆</option>
                    </select>
                </div>
            </div>

        </div>
        <div class="layui-row ">
            <div class="test-table-reload-btn" style="margin-bottom: 10px;">
                <button type="button" class="layui-btn layui-btn-danger" lay-submit lay-filter="btn_submit" id="btn_submit"><i class="layui-icon">&#xe681</i>获取医嘱</button>
            </div>
        </div>

        <div class="layui-form-item" style="margin-left:-300px;margin-top: 10px">
            <div class="layui-input-block">
                <button class="layui-btn" lay-submit lay-filter="*">立即提交</button>
                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
            </div>
        </div>
    </form>
</div>
<div>
<table class="layui-hide" id="test"></table>
</div>
<script src="/js/layui2/layui.js" charset="utf-8"></script>
<script>
    layui.use('form', function () {
       var form = layui.form;
        var $ = layui.jquery;
        loadPatient($,form);
        form.on("select(patientName)",function(data){
            findPatient(data,$,form)
        })
    });
    function loadPatient($,form) {
        $.ajax({
            url: '/call/patient/findPatient',
            type: 'get',
            success: function result(data1) {
                var options = "<option value='0' selected='selected'>请选择</option>";
                /*                jQuery.each(data1.responseBody,function (i,item) {
                                    alert(item.id);
                                    options += "<option value='" + item.id + "'>" + item.patientName + "</option>"
                                })*/
                for (var i = 0; i < data1.responseBody.length; i++) {
                    options += "<option value='" + data1.responseBody[i].id + "'>" + data1.responseBody[i].patientName + "</option>";
                }
                $("[name=patientName]").html(options);
                form.render('select');
            }
        });
    }
    function findPatient(data,$,form) {
        $.ajax({
            url:'/call/patient/findPatient',
            data:'id='+data.value,
            type:'get',
            success:function result1(data2) {
                    $("[name=gender]").val(data2.responseBody[0].gender);
                    $("[name=phone]").val(data2.responseBody[0].phone);
                    $("[name=patientNo]").val(data2.responseBody[0].patientNo);
                    $("[name=bornDate]").val(data2.responseBody[0].bornDate);
                    $("[name=patientCard]").val(data2.responseBody[0].patientCard);
                    $("[name=patientAge]").val(data2.responseBody[0].patientAge);
            }
        })
    }
    function loadDisease($,form) {
        $.ajax({
            url:'/call/desease/'
        })
    }
</script>
<script>
    layui.use('table', function(){
        var table = layui.table;
        table.render({
            elem: '#test'
            ,url:'/demo/table/user/'
            ,cols: [[
                {field:'id', width:80, title: 'ID', sort: true}
                ,{field:'username', width:80, title: '用户名'}
                ,{field:'sex', width:80, title: '性别', sort: true}
                ,{field:'city', width:80, title: '城市'}
                ,{field:'sign', title: '签名', minWidth: 150}
                ,{field:'experience', width:80, title: '积分', sort: true}
                ,{field:'score', width:80, title: '评分', sort: true}
                ,{field:'classify', width:80, title: '职业'}
                ,{field:'wealth', width:135, title: '财富', sort: true}
            ]]
            ,page: true
        });
    });
</script>
<script src="/js/layui2/formSelects-v4.js"></script>
<script type="text/javascript">
    //全局定义一次, 加载formSelects
    layui.config({
        base: '/' //此处路径请自行处理, 可以使用绝对路径
    }).extend({
        formSelects: 'formSelects-v4'
    });
    //加载模块
    layui.use(['jquery', 'formSelects'], function () {
        var formSelects = layui.formSelects;

    });
</script>

<script type="text/javascript">
    layui.use(['form', 'layer', 'jquery', 'table', 'laydate', 'element', 'upload', 'flow'], function () {
        var $$ = layui.jquery;
        var form = layui.form,
            layer = parent.layer == undefined ? layui.layer : parent.layer,
            //layer = layui.layer,
            table = layui.table,
            laydate = layui.laydate,
            element = layui.element,
            upload = layui.upload,
            flow = layui.flow;
        form.render();
        form.on('submit(btn_submit)', function (obj) {
            layer.confirm('确认录入无误吗？', {
                btn: ['确认', '再看看']
            }, function () {
                var getName = JSON.stringify(layui.formSelects.value('select_base_cityname', 'name'));//取值name数组
                var getName2 = JSON.stringify(layui.formSelects.value('select_base_cityname2', 'name'));//取值name数组
                layer.msg("你诊断选择的值为：" + getName, { offset: '150px', icon: 1, time: 5000 }, function () {
                });
                /*  layer.msg("你医嘱选择的值为：" + getName2, { offset: '150px', icon: 1, time: 5000 }, function () {
                 });*/
            });
        });
    });
</script>
</body>
</html>